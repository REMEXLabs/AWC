{"version":3,"sources":["Darwin.js"],"names":["Component","_htmlTag","_baseClass","_data","_options","testBrowserSupport","setHtmlTag","setBaseClass","opts","key","undefined","data","window","customElements","define","root","attachShadow","mode","link","document","querySelector","template","import","getElementsByTagName","_buildHtml","adaptiveElements","Array","addEventListener","_adaptiveChangeCallback","push","_pipeCallback","attrName","oldVal","newVal","e","_mergeModels","detail","call","mdl1","mdl2","mdl","x","hasOwnProperty","innerHTML","instance","content","cloneNode","div","createElement","appendChild","handlebar","Handlebars","compile","buildHtml","tag","msg","TypeError","htmlTag","klass","baseClass","HTMLElement","prototype","Components","_hasAdaptiveWebComps","event","CustomEvent","idx","el","dispatchEvent","tagName","toLowerCase","length"],"mappings":"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","file":"Darwin.js","sourcesContent":["class Component {\n\n  /**\n   * constructor - Create a new Adaptive Web Component.\n   *\n   * @param  {string} _htmlTag   The new HTML tag.\n   * @param  {class}  _baseClass The base class (e.g. HTMLElement, HTMLButtonElement, ...).\n   * @param  {object} _data      The initial model of the component.\n   */\n  constructor(_htmlTag, _baseClass, _data, _options) {\n    Component.testBrowserSupport();\n\n    this.setHtmlTag(_htmlTag);\n    this.setBaseClass(_baseClass);\n    let opts = _options || {};\n    let key = undefined;\n    let data = _data;\n\n    window.customElements.define(_htmlTag, class Tag extends _baseClass {\n      constructor() {\n        super();\n        this.root = this.attachShadow({\n          mode: 'open'\n        });\n        let link = document.querySelector('[data-tag=' + _htmlTag + ']');\n        this.template = link.import.getElementsByTagName('template')[0];\n        this._buildHtml(data);\n      }\n\n      /**\n       * connectedCallback - Implementation of the connectedCallback.\n       */\n      connectedCallback() {\n        window.adaptiveElements = window.adaptiveElements || Array();\n        this.addEventListener('adaptiveUpdate', this._adaptiveChangeCallback, false);\n        window.adaptiveElements.push(this);\n        // Attach callback:\n        this._pipeCallback('onCreate');\n      }\n\n      /**\n       * disconnectedCallback - Implementation of the disconnectedCallback.\n       */\n      disconnectedCallback() {\n        // Attach callback:\n        this._pipeCallback('onDisconnect');\n      };\n\n      /**\n       * attributeChangedCallback - description\n       *\n       * @param  {string} attrName The changed attribute.\n       * @param  {mix} oldVal   The old value.\n       * @param  {mix} newVal   The new value.\n       */\n      attributeChangedCallback(attrName, oldVal, newVal) {\n        // Attach callback:\n        this._pipeCallback('onAttributeChange');\n      }\n\n      /**\n       * adoptedCallback - Implementation of the adoptedCallback.\n       */\n      adoptedCallback() {\n        // Attach callback:\n        this._pipeCallback('onAdopted');\n      }\n\n      /**\n       * _adaptiveCallback - Definition of a new\n       * callback to make adaptive changes possible.\n       *\n       * @param  {event} e The event object.\n       */\n      _adaptiveChangeCallback(e) {\n        // Attach callback:\n        this._pipeCallback('onAdaptiveChange');\n        // Update HTML:\n        data = this._mergeModels(data, e.detail);\n        this._buildHtml(data);\n      }\n\n      /**\n       * _pipeCallback - Call the applied function.\n       *\n       * @param  {string} key The name of the callback.\n       */\n      _pipeCallback(key) {\n        if (key in opts && typeof opts[key] === \"function\") {\n          opts[key].call(this, this);\n        }\n      }\n\n      /**\n       * _mergeModels - Merge two object literals.\n       *\n       * @param  {object} mdl1 The old object literal.\n       * @param  {object} mdl2 The new object literal.\n       * @return {object}      The merged object literal.\n       */\n      _mergeModels(mdl1, mdl2) {\n        let mdl = {};\n        for (let x in mdl1) {\n          if (mdl1.hasOwnProperty(x)) {\n            mdl[x] = mdl1[x];\n          }\n        }\n        for (let x in mdl2) {\n          if (mdl2.hasOwnProperty(x)) {\n            mdl[x] = mdl2[x];\n          }\n        }\n        return mdl;\n      }\n\n      /**\n       * _buildHtml - Generate and set the HTML.\n       *\n       * @param  {object} data The model.\n       */\n      _buildHtml(data) {\n        this.root.innerHTML = '';\n        let instance = this.template.content.cloneNode(true);\n        let div = document.createElement('div');\n        div.appendChild(instance);\n        let handlebar = window.Handlebars.compile(div.innerHTML);\n        let buildHtml = handlebar(data);\n        this.root.innerHTML = buildHtml;\n      }\n    });\n  }\n\n  /**\n   * setHtmlTag - Set the name of the new HTML tag.\n   *\n   * @param  {string} tag The new HTML tag.\n   */\n  setHtmlTag(tag) {\n    if (typeof (tag) !== 'string') {\n      let msg = \"The assigned tag \" + tag + \" isn't of type 'string'.\"\n      throw new TypeError(msg);\n    }\n    this.htmlTag = tag;\n  }\n\n  /**\n   * getHtmlTag - Get the name of the defined HTML tag.\n   *\n   * @return {string}  The defined HTML tag.\n   */\n  getHtmlTag() {\n    return this.htmlTag;\n  }\n\n  /**\n   * setBaseClass - Set the known HTMLElement base class.\n   *\n   * @param  {type} klass The known base class.\n   */\n  setBaseClass(klass) {\n    if (typeof (klass) !== 'function') {\n      let msg = \"The assigned class isn't of type 'function'.\";\n      throw new TypeError(msg);\n    }\n    this.baseClass = klass;\n  }\n\n  /**\n   * getBaseClass - Get the defined base class.\n   *\n   * @return {class}       The defined base class.\n   */\n  getBaseClass() {\n    return this.baseClass;\n  }\n\n  /**\n   * testBroswerSupport - Test whether the browser support all features.\n   *\n   * @return {boolean}  Does the browser support all features?\n   */\n  static testBrowserSupport() {\n    // Version == 1.0:\n    if ('customElements' in window &&\n      !!HTMLElement.prototype.attachShadow) {\n      return true;\n      // Version < 1.0:\n    } else if (\n      'registerElement' in document &&\n      'import' in document.createElement('link') &&\n      'content' in document.createElement('template')) {\n      // At frist, do nothing.\n      // return true;\n    }\n    let msg = \"The browser doesn't support the required features.\";\n    throw new TypeError(msg);\n    return false;\n  }\n}\n\n\nclass Components {\n\n  /**\n   * updateAll - Update all Adaptive Web Components.\n   *\n   * @param  {object} data The model data.\n   */\n  static updateAll(data) {\n    if (Components._hasAdaptiveWebComps()) {\n      let event = new CustomEvent('adaptiveUpdate', {\n        detail: data\n      });\n      for (let idx in window.adaptiveElements) {\n        let el = window.adaptiveElements[idx];\n        el.dispatchEvent(event);\n      }\n    }\n  }\n\n  /**\n   * update - Update a specific Adaptive Web Component.\n   *\n   * @param  {string} htmlTag The HTML tag.\n   * @param  {object} data    The model data.\n   */\n  static update(htmlTag, data) {\n    if (Components._hasAdaptiveWebComps()) {\n      for (let idx in window.adaptiveElements) {\n        let el = window.adaptiveElements[idx];\n        if (el.tagName.toLowerCase() == htmlTag) {\n          let event = new CustomEvent('adaptiveUpdate', {\n            detail: data\n          });\n          el.dispatchEvent(event);\n        }\n      }\n    }\n  }\n\n  /**\n   * _hasAdaptiveWebComps - Whether the browser support all features or not.\n   *\n   * @return {boolean}  Whether the browser support all features or not.\n   */\n  static _hasAdaptiveWebComps() {\n    // ≠ window.customElements\n    return 'adaptiveElements' in window && window.adaptiveElements.length > 0;\n  }\n}\n"],"sourceRoot":"/source/"}